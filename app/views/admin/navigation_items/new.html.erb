<% content_for :title, "New Navigation Item" %>

<div class="admin-card">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="card-title mb-0">
      <i class="fas fa-plus me-2"></i>New Navigation Item
    </h1>
    <%= link_to "Back", admin_navigation_items_path, class: "btn btn-outline-secondary" %>
  </div>
  
  <%= form_with model: [:admin, @navigation_item], local: true do |f| %>
    <% if @navigation_item.errors.any? %>
      <div class="alert alert-danger">
        <h5><i class="fas fa-exclamation-triangle me-2"></i>Please fix the following errors:</h5>
        <ul class="mb-0">
          <% @navigation_item.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>
    
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :key, "Key (unique identifier)", class: "form-label" %>
          <%= f.text_field :key, class: "form-control", required: true, placeholder: "e.g., products, orders, users" %>
          <small class="form-text text-muted">Lowercase letters, numbers, and underscores only (e.g., products, orders)</small>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :label, "Display Label", class: "form-label" %>
          <%= f.text_field :label, class: "form-control", required: true, placeholder: "e.g., Products, Orders" %>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :icon, "Icon (Font Awesome class)", class: "form-label" %>
          <%= f.text_field :icon, class: "form-control", placeholder: "e.g., fas fa-box, fas fa-shopping-cart" %>
          <small class="form-text text-muted">Font Awesome icon class (e.g., fas fa-box)</small>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :path_method, "Route Path Method", class: "form-label" %>
          <%= f.text_field :path_method, class: "form-control", required: true, placeholder: "e.g., admin_products_path" %>
          <small class="form-text text-muted">Rails route helper (e.g., admin_products_path)</small>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :section, "Section", class: "form-label" %>
          <%= f.text_field :section, class: "form-control", placeholder: "e.g., Product Management, User Management" %>
          <small class="form-text text-muted">Leave blank for 'Other' section</small>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :controller_name, "Controller Name", class: "form-label" %>
          <%= f.text_field :controller_name, class: "form-control", placeholder: "e.g., products, orders" %>
          <small class="form-text text-muted">For active link detection</small>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-3">
        <div class="mb-3">
          <%= f.label :display_order, "Display Order", class: "form-label" %>
          <%= f.number_field :display_order, class: "form-control", value: @navigation_item.display_order || 0, min: 0 %>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="mb-3">
          <div class="form-check mt-4">
            <%= f.check_box :is_active, class: "form-check-input" %>
            <%= f.label :is_active, "Active", class: "form-check-label" %>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="mb-3">
          <div class="form-check mt-4">
            <%= f.check_box :require_super_admin, class: "form-check-input" %>
            <%= f.label :require_super_admin, "Super Admin Only", class: "form-check-label" %>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="mb-3">
          <div class="form-check mt-4">
            <%= f.check_box :always_visible, class: "form-check-input" %>
            <%= f.label :always_visible, "Always Visible", class: "form-check-label" %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mb-3">
      <%= f.label :description, class: "form-label" %>
      <%= f.text_area :description, rows: 2, class: "form-control", placeholder: "Optional description" %>
    </div>
    
    <hr class="my-4">
    <h5 class="mb-3">Action Permissions</h5>
    <div class="row">
      <div class="col-md-3">
        <div class="form-check mb-3">
          <%= f.check_box :can_view, class: "form-check-input" %>
          <%= f.label :can_view, "Can View", class: "form-check-label" %>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-check mb-3">
          <%= f.check_box :can_create, class: "form-check-input" %>
          <%= f.label :can_create, "Can Create", class: "form-check-label" %>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-check mb-3">
          <%= f.check_box :can_edit, class: "form-check-input" %>
          <%= f.label :can_edit, "Can Edit", class: "form-check-label" %>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-check mb-3">
          <%= f.check_box :can_delete, class: "form-check-input" %>
          <%= f.label :can_delete, "Can Delete", class: "form-check-label" %>
        </div>
      </div>
    </div>
    
    <hr class="my-4">
    <h5 class="mb-3">Permissions</h5>
    
    <div class="row">
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :required_permissions_array, "Required Permissions", class: "form-label" %>
          <%= f.select :required_permissions_array, 
              options_for_select(@available_permissions.map { |p| [p, p] }, @navigation_item.required_permissions_array),
              {}, 
              { class: "form-select", multiple: true, size: 5 } %>
          <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple</small>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="mb-3">
          <%= f.label :view_permissions_array, "View Permissions", class: "form-label" %>
          <%= f.select :view_permissions_array, 
              options_for_select(@available_permissions.map { |p| [p, p] }, @navigation_item.view_permissions_array),
              {}, 
              { class: "form-select", multiple: true, size: 5 } %>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-4">
        <div class="mb-3">
          <%= f.label :create_permissions_array, "Create Permissions", class: "form-label" %>
          <%= f.select :create_permissions_array, 
              options_for_select(@available_permissions.map { |p| [p, p] }, @navigation_item.create_permissions_array),
              {}, 
              { class: "form-select", multiple: true, size: 5 } %>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="mb-3">
          <%= f.label :edit_permissions_array, "Edit Permissions", class: "form-label" %>
          <%= f.select :edit_permissions_array, 
              options_for_select(@available_permissions.map { |p| [p, p] }, @navigation_item.edit_permissions_array),
              {}, 
              { class: "form-select", multiple: true, size: 5 } %>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="mb-3">
          <%= f.label :delete_permissions_array, "Delete Permissions", class: "form-label" %>
          <%= f.select :delete_permissions_array, 
              options_for_select(@available_permissions.map { |p| [p, p] }, @navigation_item.delete_permissions_array),
              {}, 
              { class: "form-select", multiple: true, size: 5 } %>
        </div>
      </div>
    </div>
    
    <div class="d-flex justify-content-end gap-2 mt-4">
      <%= link_to "Cancel", admin_navigation_items_path, class: "btn btn-outline-secondary" %>
      <%= f.submit "Create Navigation Item", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

